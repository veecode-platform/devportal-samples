#
# Starts DevPortal with hot reloading and pretty logging:
#
# docker compose up --no-log-prefix
#
# Changes to dynamic-plugins*.yaml will be processed into app-config running this:
#
# docker compose exec devportal /app/install-dynamic-plugins.sh /app/dynamic-plugins-root
#

services:
  devportal:
    image: veecode/devportal:latest
    ports:
      - "7007:7007"
    environment:
      - NODE_ENV=development
      # will use shell value
      - VEECODE_PROFILE=github
      # GITHUB
      - GITHUB_ORG
      - GITHUB_AUTH_CLIENT_ID
      - GITHUB_AUTH_CLIENT_SECRET
      - GITHUB_APP_ID
      - GITHUB_CLIENT_ID
      - GITHUB_CLIENT_SECRET
      # line breaks can cause headaches
      # - GITHUB_PRIVATE_KEY
      # encoding GITHUB_PRIVATE_KEY with base64 works better here
      - GITHUB_PRIVATE_KEY_BASE64
      - GITHUB_TOKEN
    volumes:
      # dynamic plugins config (just enable/disable plugins)
      - ./dynamic-plugins.yaml:/app/dynamic-plugins.yaml:ro
