#
# dynamic plugins defaults
#
plugins:
  - package: ./dynamic-plugins/dist/backstage-plugin-kubernetes-dynamic
    disabled: true
    pluginConfig:
      dynamicPlugins:
        frontend:
          backstage.plugin-kubernetes:
            # Declare the tab (path + title) and bind it to a mountPoint
            entityTabs:
              - path: /kubernetes
                title: Kubernetes
                mountPoint: entity.page.kubernetes
                config:
                  if:
                    allOf:
                      - hasAnnotation: backstage.io/kubernetes-label-selector
                      # - hasAnnotation: backstage.io/kubernetes-id
                      # - hasAnnotation: backstage.io/kubernetes-namespace
            mountPoints:
              - mountPoint: entity.page.kubernetes/cards
                importName: EntityKubernetesContent
                config:
                  layout:
                    gridColumn: "1 / -1"
                  if:
                    allOf:
                      - hasAnnotation: backstage.io/kubernetes-label-selector
                  # if:
                  #   anyOf:
                  #     - hasAnnotation: backstage.io/kubernetes-id
                  #     - hasAnnotation: backstage.io/kubernetes-namespace
  - package: ./dynamic-plugins/dist/red-hat-developer-hub-backstage-plugin-global-floating-action-button-dynamic
    disabled: true
    pluginConfig:
      dynamicPlugins:
        frontend:
          red-hat-developer-hub.backstage-plugin-global-floating-action-button:
            mountPoints:
              - mountPoint: application/listener
                importName: DynamicGlobalFloatingActionButton
              - mountPoint: global.floatingactionbutton/config
                importName: NullComponent
                config:
                  icon: github
                  label: 'Git'
                  toolTip: 'Github'
                  to: https://github.com/veecode-platform/devportal-distro

  - package: ./dynamic-plugins/dist/roadiehq-backstage-plugin-security-insights-dynamic
    disabled: true
    pluginConfig:
      dynamicPlugins:
        frontend:
          roadiehq.backstage-plugin-security-insights:
            # 1) Declare the tab (path + title) and bind it to a mountPoint
            entityTabs:
              - path: /security-insights
                title: Security Insights
                mountPoint: entity.page.security-insights
                # (optional) move it left/right in the tab bar
                # priority: -1
                config:
                  if:
                    allOf:
                      - isSecurityInsightsAvailable
            mountPoints:
              - mountPoint: entity.page.security-insights/cards
                importName: EntitySecurityInsightsContent
                config:
                  layout:
                    gridColumn: "1 / -1"   # full width page content
                  if:
                    allOf:
                      - isSecurityInsightsAvailable
              - mountPoint: entity.page.overview/cards
                importName: EntityDependabotAlertsCard
                config:
                  layout:
                    gridRowStart:
                      lg: "-1"           # Row 2 (About is likely row 1)
                    gridColumnStart:
                      lg: "5"           # Right side, start at column 7
                    gridColumnEnd:
                      lg: "-1"          # Extend to end
                      md: "span 12"
                      xs: "span 12"
                  if:
                    allOf:
                      - isSecurityInsightsAvailable
  - package: ./dynamic-plugins/dist/roadiehq-backstage-plugin-github-insights-dynamic
    disabled: true
    pluginConfig:
      dynamicPlugins:
        frontend:
          roadiehq.backstage-plugin-github-insights:
            entityTabs:
              - path: /code-insights
                title: Code Insights
                mountPoint: entity.page.code-insights
                config:
                  if:
                    allOf:
                      - isGithubInsightsAvailable   # only show when it makes sense
                      - hasAnnotation: "github.com/project-slug"
            mountPoints:
              - mountPoint: entity.page.code-insights/cards
                importName: EntityGithubInsightsContent
                config:
                  layout:
                    gridColumn: "1 / -1"   # full width page content
                  if:
                    allOf:
                      - isGithubInsightsAvailable   # only show when it makes sense
                      - hasAnnotation: "github.com/project-slug"
            # mountPoints:
            #   - mountPoint: entity.page.overview/cards
            #     importName: EntityGithubInsightsLanguagesCard
            #     config:
            #       layout:
            #         gridRowEnd:
            #           lg: "span 2"
            #         gridColumnStart:
            #           lg: "5"           # Right side
            #         gridColumnEnd:
            #           lg: "-1"          # Extend to end
            #           md: "span 12"
            #           xs: "span 12"                
            #       if:
            #         allOf:
            #           - isGithubInsightsAvailable
            #   - mountPoint: entity.page.overview/cards
            #     importName: EntityGithubInsightsComplianceCard
            #     config:
            #       layout:
            #         gridColumnStart:
            #           lg: "1"
            #         gridColumnEnd:
            #           lg: "span 4"      # Left half
            #           md: "span 4"
            #           xs: "span 6"
            #       if:
            #         allOf:
            #           - isGithubInsightsAvailable
                      
  - package: ./dynamic-plugins/dist/backstage-community-plugin-github-actions-dynamic
    disabled: true
    pluginConfig:
      dynamicPlugins:
        frontend:
          backstage-community.plugin-github-actions:
            mountPoints:
              - mountPoint: entity.page.ci/cards
                importName: EntityGithubActionsContent
                config:
                  layout:
                    gridColumn: "1 / -1"
                  if:
                    allOf:
                      - isGithubActionsAvailable

  - package: ./dynamic-plugins/dist/veecode-platform-backstage-plugin-github-workflows-backend-dynamic
    disabled: true

  - package: ./dynamic-plugins/dist/veecode-platform-backstage-plugin-github-workflows-dynamic
    disabled: true
    pluginConfig:
      dynamicPlugins:
        frontend:
          veecode-platform.backstage-plugin-github-workflows:
            mountPoints:
              - mountPoint: entity.page.overview/cards
                importName: EntityGithubWorkflowsCard
                config:
                  layout:
                    gridRowStart:
                      lg: "4"
                    gridColumnStart:
                      lg: "1"
                    gridColumnEnd:
                      lg: "span 6"
                  if:
                    anyOf:
                      - hasAnnotation: "github.com/workflows"
                      - hasAnnotation: "vee.codes/has-github-workflows"

  - package: ./dynamic-plugins/dist/backstage-community-plugin-azure-devops-dynamic
    disabled: true
    pluginConfig:
      dynamicPlugins:
        frontend:
          backstage-community.plugin-azure-devops:
            mountPoints:
              - mountPoint: entity.page.ci/cards
                importName: EntityAzurePipelinesContent
                config:
                  layout:
                    gridColumn: "1 / -1"
                  # if:
                  #   allOf:
                  #     - isAzureDevOpsAvailable
              - mountPoint: entity.page.pull-requests/cards
                importName: EntityAzurePullRequestsContent
                config:
                  layout:
                    gridColumn: "1 / -1"
                  # if:
                  #   allOf:
                  #     - isAzureDevOpsAvailable

